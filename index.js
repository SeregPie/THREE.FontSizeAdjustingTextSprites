!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("three"),require("@seregpie/three.text-texture")):"function"==typeof define&&define.amd?define(["three","@seregpie/three.text-texture"],e):((t=t||self).THREE=t.THREE||{},t.THREE.TextSprite=e(t.THREE,t.THREE.TextTexture))}(this,(function(t,e){"use strict";function i(t){return new Promise((function(e){e(t())}))}function r(){var t=this;return i((function(){var e=t,r=e.fontSize,n=e.material,o=e.scale,a=n.map,p=a.height,f=a.image;return p*=r,i((function(){return a.redraw()})).then((function(){o.set(f.width/f.height,1,1).multiplyScalar(p)}))}))}e=e&&e.hasOwnProperty("default")?e.default:e;var n=function(i){function n(n){void 0===n&&(n={});var o=n.fontSize;void 0===o&&(o=1);var a=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&-1===e.indexOf(r)&&(i[r]=t[r]);return i}(n,["fontSize"]);i.call(this,new t.SpriteMaterial({depthWrite:!1,map:new e(Object.assign({},a,{fontSize:0}))})),Object.assign(this,{fontSize:o,updateScale:r})}return i&&(n.__proto__=i),n.prototype=Object.create(i&&i.prototype),n.prototype.constructor=n,n.prototype.onBeforeRender=function(e,i,r){var n=this.material.map;n.fontSize=t.Math.ceilPowerOfTwo(n.computeOptimalFontSize(this,e,r)),this.updateScale()},n.prototype.dispose=function(){var t=this.material;t.map.dispose(),t.dispose()},n}(t.Sprite),o={isTextSprite:!0},a=n.prototype;return["align","fillStyle","fontFamily","fontStyle","fontVariant","fontWeight","lineGap","padding","strokeStyle","strokeWidth","text"].forEach((function(t){Object.defineProperty(a,t,{get:function(){return this.material.map[t]},set:function(e){this.material.map[t]=e,this.updateScale()}})})),Object.assign(a,o),n}));
